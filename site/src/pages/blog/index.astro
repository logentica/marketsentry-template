---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all blog posts, sorted by date
const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<BaseLayout title="Blog - Simple Site" description="Articles and updates from Simple Site">
  <section class="py-20">
    <div class="container">
      <div class="max-w-3xl mx-auto">
        <h1 class="text-gray-900 mb-4">Blog</h1>
        <p class="text-xl text-gray-600 mb-12">
          Articles, tutorials, and updates.
        </p>
        
        {posts.length === 0 ? (
          <div class="text-center py-12 bg-gray-50 rounded-lg">
            <p class="text-gray-600">No posts yet. Add Markdown files to <code class="bg-gray-200 px-2 py-1 rounded">src/content/blog/</code></p>
          </div>
        ) : (
          <div class="space-y-8">
            {posts.map((post) => (
              <article class="card hover:shadow-md transition-shadow">
                <a href={`/blog/${post.slug}`} class="block">
                  <h2 class="text-xl font-semibold text-gray-900 hover:text-primary-600 mb-2">
                    {post.data.title}
                  </h2>
                  <time class="text-sm text-gray-500 block mb-3">
                    {post.data.pubDate.toLocaleDateString('en-US', {
                      year: 'numeric',
                      month: 'long',
                      day: 'numeric'
                    })}
                  </time>
                  <p class="text-gray-600">{post.data.description}</p>
                </a>
              </article>
            ))}
          </div>
        )}
      </div>
    </div>
  </section>
</BaseLayout>
